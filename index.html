<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CineSearch Pro | INNOCENT TECH</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #10b981;
            --primary-dark: #059669;
            --secondary: #064e3b;
            --accent: #f59e0b;
            --light: #f8fafc;
            --dark: #0f172a;
            --gray: #64748b;
            --success: #22c55e;
            --warning: #f59e0b;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            --radius: 12px;
            --transition: all 0.3s ease;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--secondary) 0%, var(--dark) 100%);
            min-height: 100vh;
            color: var(--light);
            line-height: 1.6;
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(16, 185, 129, 0.15) 0%, transparent 40%),
                radial-gradient(circle at 80% 20%, rgba(245, 158, 11, 0.1) 0%, transparent 40%);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 30px 0;
            position: relative;
        }

        .brand-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .brand-logo {
            font-size: 2.8em;
            color: var(--primary);
            margin-right: 15px;
            text-shadow: 0 0 10px rgba(16, 185, 129, 0.5);
        }

        .brand-text {
            font-size: 2.5em;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .creator-badge {
            position: absolute;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            color: white;
            padding: 8px 18px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            box-shadow: 0 3px 10px rgba(16, 185, 129, 0.3);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tagline {
            font-size: 1.2em;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto 20px;
            color: #cbd5e1;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 25px 0;
            text-align: center;
        }

        .stat-item {
            padding: 15px;
        }

        .stat-number {
            font-size: 2.2em;
            font-weight: 700;
            color: var(--accent);
            display: block;
            text-shadow: 0 0 10px rgba(245, 158, 11, 0.3);
        }

        .stat-label {
            font-size: 0.9em;
            color: var(--gray);
        }

        .search-container {
            background: rgba(15, 23, 42, 0.8);
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .search-box {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        input[type="text"] {
            flex: 1;
            padding: 18px 20px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius);
            font-size: 16px;
            transition: var(--transition);
            outline: none;
            background: rgba(30, 41, 59, 0.8);
            color: white;
        }

        input[type="text"]:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.2);
            background: rgba(51, 65, 85, 0.9);
        }

        input[type="text"]::placeholder {
            color: #94a3b8;
        }

        button {
            padding: 18px 30px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border: none;
            border-radius: var(--radius);
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.3);
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(16, 185, 129, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .filters {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .filter-group {
            flex: 1;
            min-width: 200px;
        }

        .filter-group label {
            display: block;
            margin-bottom: 8px;
            color: #cbd5e1;
            font-weight: 500;
        }

        select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: var(--radius);
            font-size: 14px;
            background: rgba(30, 41, 59, 0.8);
            color: white;
            cursor: pointer;
            transition: var(--transition);
        }

        select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.2);
        }

        .loading {
            text-align: center;
            padding: 40px;
            display: none;
        }

        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top: 4px solid var(--primary);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .results-container {
            display: none;
            margin-bottom: 30px;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .results-count {
            font-size: 1.2em;
            font-weight: 600;
        }

        .sort-options select {
            width: auto;
            min-width: 180px;
        }

        .movies-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 25px;
        }

        .movie-card {
            background: rgba(30, 41, 59, 0.8);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: 1px solid rgba(255, 255, 255, 0.05);
            position: relative;
        }

        .movie-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
            border-color: rgba(16, 185, 129, 0.3);
        }

        .movie-poster {
            width: 100%;
            height: 350px;
            object-fit: cover;
            transition: var(--transition);
        }

        .movie-card:hover .movie-poster {
            transform: scale(1.05);
        }

        .movie-info {
            padding: 20px;
            position: relative;
        }

        .movie-title {
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 8px;
            line-height: 1.3;
            color: white;
        }

        .movie-year {
            color: var(--gray);
            font-size: 0.9em;
            margin-bottom: 10px;
        }

        .movie-rating {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 10px;
        }

        .rating-value {
            font-weight: 600;
            color: var(--accent);
        }

        .movie-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn {
            padding: 10px 15px;
            border-radius: 6px;
            font-size: 0.9em;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 5px;
            flex: 1;
            justify-content: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border: none;
            box-shadow: 0 3px 10px rgba(16, 185, 129, 0.3);
        }

        .btn-secondary {
            background: transparent;
            color: var(--primary);
            border: 1px solid var(--primary);
        }

        .btn:hover {
            transform: translateY(-2px);
        }

        .movie-details {
            display: none;
            background: rgba(15, 23, 42, 0.9);
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
        }

        .details-header {
            display: flex;
            gap: 30px;
            margin-bottom: 25px;
        }

        .details-poster {
            width: 280px;
            border-radius: var(--radius);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
        }

        .details-info {
            flex: 1;
        }

        .details-title {
            font-size: 2.2em;
            font-weight: 700;
            margin-bottom: 10px;
            color: white;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }

        .details-meta {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            color: var(--gray);
            flex-wrap: wrap;
        }

        .details-rating {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 15px;
        }

        .details-overview {
            margin-bottom: 20px;
            line-height: 1.7;
            color: #cbd5e1;
        }

        .details-actions {
            display: flex;
            gap: 15px;
        }

        .error {
            background: rgba(220, 53, 69, 0.2);
            color: #ff6b7a;
            padding: 15px 20px;
            border-radius: var(--radius);
            margin-bottom: 20px;
            display: none;
            border-left: 4px solid #dc3545;
            backdrop-filter: blur(10px);
        }

        .no-results {
            text-align: center;
            padding: 50px;
            background: rgba(30, 41, 59, 0.8);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            display: none;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .no-results i {
            font-size: 4em;
            margin-bottom: 20px;
            color: var(--gray);
            opacity: 0.5;
        }

        .no-results h3 {
            font-size: 1.5em;
            margin-bottom: 10px;
            color: white;
        }

        .no-results p {
            color: #94a3b8;
        }

        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 30px;
        }

        .page-btn {
            padding: 10px 15px;
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 6px;
            color: white;
            cursor: pointer;
            transition: var(--transition);
        }

        .page-btn.active {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border-color: var(--primary);
        }

        .page-btn:hover:not(.active) {
            background: rgba(51, 65, 85, 0.8);
        }

        footer {
            text-align: center;
            padding: 30px 0;
            color: #94a3b8;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
            margin-top: 30px;
        }

        .footer-brand {
            font-weight: 700;
            color: var(--primary);
        }

        .featured-section {
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 1.8em;
            margin-bottom: 20px;
            color: white;
            text-align: center;
            position: relative;
            padding-bottom: 10px;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 3px;
            background: linear-gradient(135deg, var(--primary) 0%, var(--accent) 100%);
            border-radius: 2px;
        }

        /* Video Player Styles */
        .video-player {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .video-container {
            width: 80%;
            max-width: 1000px;
            position: relative;
        }

        .video-player video {
            width: 100%;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .close-video {
            position: absolute;
            top: -40px;
            right: 0;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2em;
            transition: var(--transition);
        }

        .close-video:hover {
            background: var(--primary-dark);
            transform: scale(1.1);
        }

        .play-btn {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.5em;
            transition: var(--transition);
            box-shadow: 0 5px 15px rgba(16, 185, 129, 0.4);
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2;
        }

        .play-btn:hover {
            transform: translate(-50%, -50%) scale(1.1);
        }

        .movie-poster-container {
            position: relative;
            overflow: hidden;
        }

        .movie-poster-container:hover .play-btn {
            opacity: 1;
        }

        @media (max-width: 768px) {
            .search-box {
                flex-direction: column;
            }
            
            .details-header {
                flex-direction: column;
            }
            
            .details-poster {
                width: 100%;
                max-width: 300px;
                margin: 0 auto;
            }
            
            .movies-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
            
            .filters {
                flex-direction: column;
            }
            
            .creator-badge {
                position: static;
                margin: 0 auto 15px;
                width: fit-content;
            }
            
            .stats {
                flex-direction: column;
                gap: 15px;
            }
            
            .video-container {
                width: 95%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="creator-badge">
                <i class="fas fa-code"></i> Created by INNOCENT TECH
            </div>
            <div class="brand-container">
                <i class="fas fa-film brand-logo"></i>
                <div class="brand-text">CineSearch Pro</div>
            </div>
            <p class="tagline">Discover, search, and explore thousands of movies with our powerful cinematic search engine</p>
            
            <div class="stats">
                <div class="stat-item">
                    <span class="stat-number">15K+</span>
                    <span class="stat-label">Movies</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">99%</span>
                    <span class="stat-label">Success Rate</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">4.8</span>
                    <span class="stat-label">User Rating</span>
                </div>
            </div>
        </header>

        <div class="search-container">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Search for movies by title, actor, or genre..." />
                <button onclick="searchMovies()" id="searchBtn">
                    <i class="fas fa-search"></i> Search Movies
                </button>
            </div>
            
            <div class="filters">
                <div class="filter-group">
                    <label for="genreFilter"><i class="fas fa-tags"></i> Genre</label>
                    <select id="genreFilter">
                        <option value="">All Genres</option>
                        <option value="action">Action</option>
                        <option value="comedy">Comedy</option>
                        <option value="drama">Drama</option>
                        <option value="horror">Horror</option>
                        <option value="sci-fi">Sci-Fi</option>
                        <option value="thriller">Thriller</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="yearFilter"><i class="far fa-calendar"></i> Year</label>
                    <select id="yearFilter">
                        <option value="">Any Year</option>
                        <option value="2023">2023</option>
                        <option value="2022">2022</option>
                        <option value="2021">2021</option>
                        <option value="2020">2020</option>
                        <option value="2019">2019</option>
                        <option value="2010-2018">2010-2018</option>
                        <option value="2000-2009">2000-2009</option>
                        <option value="1990-1999">1990-1999</option>
                        <option value="1980-1989">1980-1989</option>
                    </select>
                </div>
                
                <div class="filter-group">
                    <label for="ratingFilter"><i class="fas fa-star"></i> Minimum Rating</label>
                    <select id="ratingFilter">
                        <option value="0">Any Rating</option>
                        <option value="7">7+</option>
                        <option value="8">8+</option>
                        <option value="9">9+</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="error" id="error"></div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Searching our cinematic database...</p>
        </div>

        <!-- Featured Movies Section -->
        <div class="featured-section" id="featuredMovies">
            <h2 class="section-title">Featured Movies</h2>
            <div class="movies-grid" id="featuredMoviesGrid"></div>
        </div>

        <div class="results-container" id="resultsContainer">
            <div class="results-header">
                <div class="results-count" id="resultsCount">Found 0 movies</div>
                <div class="sort-options">
                    <select id="sortOptions">
                        <option value="relevance">Sort by Relevance</option>
                        <option value="year">Sort by Year</option>
                        <option value="rating">Sort by Rating</option>
                        <option value="title">Sort by Title</option>
                    </select>
                </div>
            </div>
            
            <div class="movies-grid" id="moviesGrid"></div>
            
            <div class="pagination" id="pagination"></div>
        </div>

        <div class="no-results" id="noResults">
            <i class="fas fa-film"></i>
            <h3>No movies found</h3>
            <p>Try adjusting your search terms or filters</p>
        </div>

        <div class="movie-details" id="movieDetails"></div>

        <!-- Video Player -->
        <div class="video-player" id="videoPlayer">
            <div class="video-container">
                <button class="close-video" onclick="closeVideoPlayer()">
                    <i class="fas fa-times"></i>
                </button>
                <video id="movieVideo" controls>
                    Your browser does not support the video tag.
                </video>
            </div>
        </div>

        <footer>
            <p>CineSearch Pro &copy; 2023 | Powered by Plex API</p>
            <p>Created with ❤️ by <span class="footer-brand">INNOCENT TECH</span> for movie enthusiasts</p>
        </footer>
    </div>

    <script>
        // API Configuration
        const API_URL = 'https://casper-tech-apis.vercel.app/api/movie/plex/search';
        let currentPage = 1;
        let currentQuery = '';
        let currentMovies = [];

        // Example movies to display on page load
        const exampleMovies = [
            {
                id: 'example1',
                title: 'The Matrix',
                year: '1999',
                rating: 8.7,
                poster: 'https://image.tmdb.org/t/p/w500/f89U3ADr1oiB1s9GkdPOEpXUk5H.jpg',
                overview: 'A computer hacker learns from mysterious rebels about the true nature of his reality and his role in the war against its controllers.',
                genre: 'Sci-Fi',
                runtime: '136 min',
                cast: ['Keanu Reeves', 'Laurence Fishburne', 'Carrie-Anne Moss'],
                trailer: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4'
            },
            {
                id: 'example2',
                title: 'Inception',
                year: '2010',
                rating: 8.8,
                poster: 'https://image.tmdb.org/t/p/w500/9gk7adHYeDvHkCSEqAvQNLV5Uge.jpg',
                overview: 'A thief who steals corporate secrets through the use of dream-sharing technology is given the inverse task of planting an idea into the mind of a C.E.O.',
                genre: 'Sci-Fi',
                runtime: '148 min',
                cast: ['Leonardo DiCaprio', 'Joseph Gordon-Levitt', 'Ellen Page'],
                trailer: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerEscapes.mp4'
            },
            {
                id: 'example3',
                title: 'The Dark Knight',
                year: '2008',
                rating: 9.0,
                poster: 'https://image.tmdb.org/t/p/w500/qJ2tW6WMUDux911r6m7haRef0WH.jpg',
                overview: 'When the menace known as the Joker wreaks havoc and chaos on the people of Gotham, Batman must accept one of the greatest psychological and physical tests of his ability to fight injustice.',
                genre: 'Action',
                runtime: '152 min',
                cast: ['Christian Bale', 'Heath Ledger', 'Aaron Eckhart'],
                trailer: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerFun.mp4'
            },
            {
                id: 'example4',
                title: 'Pulp Fiction',
                year: '1994',
                rating: 8.9,
                poster: 'https://image.tmdb.org/t/p/w500/d5iIlFn5s0ImszYzBPb8JPIfbXD.jpg',
                overview: 'The lives of two mob hitmen, a boxer, a gangster and his wife, and a pair of diner bandits intertwine in four tales of violence and redemption.',
                genre: 'Crime',
                runtime: '154 min',
                cast: ['John Travolta', 'Uma Thurman', 'Samuel L. Jackson'],
                trailer: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerJoyrides.mp4'
            },
            {
                id: 'example5',
                title: 'The Shawshank Redemption',
                year: '1994',
                rating: 9.3,
                poster: 'https://image.tmdb.org/t/p/w500/q6y0Go1tsGEsmtFryDOJo3dEmqu.jpg',
                overview: 'Two imprisoned men bond over a number of years, finding solace and eventual redemption through acts of common decency.',
                genre: 'Drama',
                runtime: '142 min',
                cast: ['Tim Robbins', 'Morgan Freeman', 'Bob Gunton'],
                trailer: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerMeltdowns.mp4'
            },
            {
                id: 'example6',
                title: 'Avengers: Endgame',
                year: '2019',
                rating: 8.4,
                poster: 'https://image.tmdb.org/t/p/w500/or06FN3Dka5tukK1e9sl16pB3iy.jpg',
                overview: 'After the devastating events of Avengers: Infinity War, the universe is in ruins. With the help of remaining allies, the Avengers assemble once more in order to reverse Thanos actions and restore balance to the universe.',
                genre: 'Action',
                runtime: '181 min',
                cast: ['Robert Downey Jr.', 'Chris Evans', 'Scarlett Johansson'],
                trailer: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4'
            }
        ];

        // DOM Elements
        const searchInput = document.getElementById('searchInput');
        const searchBtn = document.getElementById('searchBtn');
        const loading = document.getElementById('loading');
        const resultsContainer = document.getElementById('resultsContainer');
        const moviesGrid = document.getElementById('moviesGrid');
        const featuredMoviesGrid = document.getElementById('featuredMoviesGrid');
        const resultsCount = document.getElementById('resultsCount');
        const noResults = document.getElementById('noResults');
        const errorDiv = document.getElementById('error');
        const movieDetails = document.getElementById('movieDetails');
        const pagination = document.getElementById('pagination');
        const sortOptions = document.getElementById('sortOptions');
        const videoPlayer = document.getElementById('videoPlayer');
        const movieVideo = document.getElementById('movieVideo');

        // Event Listeners
        searchInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                searchMovies();
            }
        });

        sortOptions.addEventListener('change', function() {
            sortMovies(this.value);
        });

        // Display example movies on page load
        function displayExampleMovies() {
            featuredMoviesGrid.innerHTML = '';
            
            exampleMovies.forEach(movie => {
                const movieCard = document.createElement('div');
                movieCard.className = 'movie-card';
                
                movieCard.innerHTML = `
                    <div class="movie-poster-container">
                        <img src="${movie.poster}" alt="${movie.title}" class="movie-poster" onerror="this.src='https://via.placeholder.com/300x450/1e293b/ffffff?text=No+Poster'">
                        <button class="play-btn" onclick="playMovie('${movie.id}')">
                            <i class="fas fa-play"></i>
                        </button>
                    </div>
                    <div class="movie-info">
                        <div class="movie-title">${movie.title}</div>
                        <div class="movie-year">${movie.year}</div>
                        <div class="movie-rating">
                            <i class="fas fa-star" style="color: #f59e0b;"></i>
                            <span class="rating-value">${movie.rating}</span>
                        </div>
                        <div class="movie-actions">
                            <button class="btn btn-primary" onclick="showExampleMovieDetails('${movie.id}')">
                                <i class="fas fa-info-circle"></i> Details
                            </button>
                            <button class="btn btn-secondary" onclick="addToWatchlist('${movie.id}')">
                                <i class="fas fa-plus"></i> Watchlist
                            </button>
                        </div>
                    </div>
                `;
                
                featuredMoviesGrid.appendChild(movieCard);
            });
        }

        // Play movie trailer
        function playMovie(movieId) {
            const movie = exampleMovies.find(m => m.id === movieId) || currentMovies.find(m => m.id === movieId);
            
            if (movie && movie.trailer) {
                movieVideo.src = movie.trailer;
                videoPlayer.style.display = 'flex';
                movieVideo.play();
            } else {
                showError('Trailer not available for this movie');
            }
        }

        // Close video player
        function closeVideoPlayer() {
            videoPlayer.style.display = 'none';
            movieVideo.pause();
            movieVideo.src = '';
        }

        // Show example movie details
        function showExampleMovieDetails(movieId) {
            const movie = exampleMovies.find(m => m.id === movieId);
            
            if (!movie) {
                showError('Movie details not available');
                return;
            }
            
            movieDetails.innerHTML = `
                <div class="details-header">
                    <img src="${movie.poster}" alt="${movie.title}" class="details-poster" onerror="this.src='https://via.placeholder.com/300x450/1e293b/ffffff?text=No+Poster'">
                    <div class="details-info">
                        <h1 class="details-title">${movie.title}</h1>
                        <div class="details-meta">
                            <span><i class="far fa-calendar"></i> ${movie.year}</span>
                            <span><i class="far fa-clock"></i> ${movie.runtime}</span>
                            <span><i class="fas fa-film"></i> ${movie.genre}</span>
                        </div>
                        <div class="details-rating">
                            <i class="fas fa-star" style="color: #f59e0b;"></i>
                            <span class="rating-value">${movie.rating}</span>
                        </div>
                        <p class="details-overview">${movie.overview}</p>
                        <div class="details-actions">
                            <button class="btn btn-primary" onclick="playMovie('${movie.id}')">
                                <i class="fas fa-play"></i> Watch Trailer
                            </button>
                            <button class="btn btn-secondary" onclick="addToWatchlist('${movie.id}')">
                                <i class="fas fa-plus"></i> Add to Watchlist
                            </button>
                        </div>
                    </div>
                </div>
                <div class="details-cast">
                    <h3>Cast</h3>
                    <p>${movie.cast.join(', ')}</p>
                </div>
            `;
            
            movieDetails.style.display = 'block';
            
            // Scroll to details
            movieDetails.scrollIntoView({ behavior: 'smooth' });
        }

        // Main search function
        async function searchMovies() {
            const query = searchInput.value.trim();
            
            if (!query) {
                showError('Please enter a search term');
                return;
            }

            currentQuery = query;
            currentPage = 1;
            
            // Show loading state
            loading.style.display = 'block';
            resultsContainer.style.display = 'none';
            noResults.style.display = 'none';
            errorDiv.style.display = 'none';
            movieDetails.style.display = 'none';
            searchBtn.disabled = true;
            searchBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Searching...';

            try {
                // Build API URL with query parameters
                const apiUrl = `${API_URL}?query=${encodeURIComponent(query)}`;
                console.log('Fetching:', apiUrl);
                
                const response = await fetch(apiUrl);
                
                if (!response.ok) {
                    throw new Error(`API error! status: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('API Response:', data);

                if (!data || data.length === 0) {
                    showNoResults();
                    return;
                }

                // Process and display results
                currentMovies = data;
                displayMovies(data);
                updateResultsCount(data.length);
                showResults();
                
            } catch (error) {
                console.error('Error:', error);
                showError(`Search failed: ${error.message}`);
            } finally {
                loading.style.display = 'none';
                searchBtn.disabled = false;
                searchBtn.innerHTML = '<i class="fas fa-search"></i> Search Movies';
            }
        }

        // Display movies in grid
        function displayMovies(movies) {
            moviesGrid.innerHTML = '';
            
            movies.forEach(movie => {
                const movieCard = document.createElement('div');
                movieCard.className = 'movie-card';
                
                // Use placeholder image if no poster available
                const posterUrl = movie.poster || 'https://via.placeholder.com/300x450/1e293b/ffffff?text=No+Poster';
                const year = movie.year || 'Unknown';
                const rating = movie.rating ? movie.rating.toFixed(1) : 'N/A';
                
                movieCard.innerHTML = `
                    <div class="movie-poster-container">
                        <img src="${posterUrl}" alt="${movie.title}" class="movie-poster" onerror="this.src='https://via.placeholder.com/300x450/1e293b/ffffff?text=No+Poster'">
                        <button class="play-btn" onclick="playMovie('${movie.id}')">
                            <i class="fas fa-play"></i>
                        </button>
                    </div>
                    <div class="movie-info">
                        <div class="movie-title">${movie.title}</div>
                        <div class="movie-year">${year}</div>
                        <div class="movie-rating">
                            <i class="fas fa-star" style="color: #f59e0b;"></i>
                            <span class="rating-value">${rating}</span>
                        </div>
                        <div class="movie-actions">
                            <button class="btn btn-primary" onclick="showMovieDetails('${movie.id}')">
                                <i class="fas fa-info-circle"></i> Details
                            </button>
                            <button class="btn btn-secondary" onclick="addToWatchlist('${movie.id}')">
                                <i class="fas fa-plus"></i> Watchlist
                            </button>
                        </div>
                    </div>
                `;
                
                moviesGrid.appendChild(movieCard);
            });
        }

        // Show movie details
        function showMovieDetails(movieId) {
            const movie = currentMovies.find(m => m.id === movieId);
            
            if (!movie) {
                showError('Movie details not available');
                return;
            }
            
            const posterUrl = movie.poster || 'https://via.placeholder.com/300x450/1e293b/ffffff?text=No+Poster';
            const year = movie.year || 'Unknown';
            const rating = movie.rating ? movie.rating.toFixed(1) : 'N/A';
            const overview = movie.overview || 'No description available.';
            
            movieDetails.innerHTML = `
                <div class="details-header">
                    <img src="${posterUrl}" alt="${movie.title}" class="details-poster" onerror="this.src='https://via.placeholder.com/300x450/1e293b/ffffff?text=No+Poster'">
                    <div class="details-info">
                        <h1 class="details-title">${movie.title}</h1>
                        <div class="details-meta">
                            <span><i class="far fa-calendar"></i> ${year}</span>
                            <span><i class="far fa-clock"></i> ${movie.runtime || 'N/A'} min</span>
                            <span><i class="fas fa-film"></i> ${movie.genre || 'Unknown'}</span>
                        </div>
                        <div class="details-rating">
                            <i class="fas fa-star" style="color: #f59e0b;"></i>
                            <span class="rating-value">${rating}</span>
                            <span>${movie.votes ? `(${movie.votes} votes)` : ''}</span>
                        </div>
                        <p class="details-overview">${overview}</p>
                        <div class="details-actions">
                            <button class="btn btn-primary" onclick="playMovie('${movie.id}')">
                                <i class="fas fa-play"></i> Watch Trailer
                            </button>
                            <button class="btn btn-secondary" onclick="addToWatchlist('${movie.id}')">
                                <i class="fas fa-plus"></i> Add to Watchlist
                            </button>
                        </div>
                    </div>
                </div>
                <div class="details-cast">
                    <h3>Cast</h3>
                    <p>${movie.cast ? movie.cast.join(', ') : 'Cast information not available'}</p>
                </div>
            `;
            
            movieDetails.style.display = 'block';
            
            // Scroll to details
            movieDetails.scrollIntoView({ behavior: 'smooth' });
        }

        // Sort movies
        function sortMovies(criteria) {
            let sortedMovies = [...currentMovies];
            
            switch(criteria) {
                case 'year':
                    sortedMovies.sort((a, b) => (b.year || 0) - (a.year || 0));
                    break;
                case 'rating':
                    sortedMovies.sort((a, b) => (b.rating || 0) - (a.rating || 0));
                    break;
                case 'title':
                    sortedMovies.sort((a, b) => (a.title || '').localeCompare(b.title || ''));
                    break;
                default:
                    // Default relevance sorting (keep original order)
                    break;
            }
            
            displayMovies(sortedMovies);
        }

        // Add to watchlist (placeholder function)
        function addToWatchlist(movieId) {
            showMessage('Movie added to your watchlist!', 'success');
        }

        // Update results count
        function updateResultsCount(count) {
            resultsCount.textContent = `Found ${count} movie${count !== 1 ? 's' : ''}`;
        }

        // Show results container
        function showResults() {
            resultsContainer.style.display = 'block';
            noResults.style.display = 'none';
            document.getElementById('featuredMovies').style.display = 'none';
        }

        // Show no results message
        function showNoResults() {
            resultsContainer.style.display = 'none';
            noResults.style.display = 'block';
            document.getElementById('featuredMovies').style.display = 'block';
        }

        // Show error message
        function showError(message) {
            errorDiv.innerHTML = `<i class="fas fa-exclamation-triangle"></i> ${message}`;
            errorDiv.style.display = 'block';
            setTimeout(() => {
                errorDiv.style.display = 'none';
            }, 5000);
        }

        // Show success message
        function showMessage(message, type) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;
            messageDiv.innerHTML = `<i class="fas fa-check-circle"></i> ${message}`;
            messageDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? 'rgba(34, 197, 94, 0.9)' : 'rgba(220, 53, 69, 0.9)'};
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
                z-index: 1000;
                backdrop-filter: blur(10px);
                animation: slideIn 0.3s ease;
            `;
            
            document.body.appendChild(messageDiv);
            
            setTimeout(() => {
                messageDiv.remove();
            }, 3000);
        }

        // Initialize with example movies
        window.addEventListener('DOMContentLoaded', function() {
            displayExampleMovies();
        });
    </script>
</body>
</html>
